<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of Antibiotic Resistance Tests with Package `antibioticR` • antibioticR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of Antibiotic Resistance Tests with Package `antibioticR`">
<meta property="og:description" content="antibioticR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">antibioticR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Analysis of Antibiotic Resistance Tests with Package `antibioticR`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of Antibiotic Resistance Tests with Package <code>antibioticR</code>
</h1>
                        <h4 class="author">Thomas Petzoldt</h4>
            
            <h4 class="date">2020-04-15</h4>
      
      
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<!--
possible output options are:
rmarkdown::pdf_document
rmarkdown::html_vignette

set to UTF if necessary with:
%\VignetteEncoding{UTF-8}

Bibliographies may need to set the LANG environment variable
LANG=en_US.UTF-8
-->
<p><strong>Please note:</strong> This document reflects work in progress and will be updated from time to time. The most recent copy can be downloaded from <a href="https://github.com/tpetzoldt/" class="uri">https://github.com/tpetzoldt/</a></p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>During the 20th century, antimicrobial agents like antibiotics (that are active against bacteria), antivirals, antifungals and other substances that are active against parasites (e.g. against malaria) have made modern medicine possible <span class="citation">(Antimicrobial Resistance 2016)</span>. However, the dramatic increase of resistant and multiresistant bacterial pathogens is now been widely recognized as a global challenge for human health <span class="citation">(Roca et al. 2015; Antimicrobial Resistance 2016; ECDC 2017)</span>.</p>
<p>As there is currently still lack in understanding how environmental factors influence evolution and transmission of antibiotic resistances, “global efforts are required to characterize and quantify antibiotic resistance in the environment” <span class="citation">(Berendonk et al. 2015)</span>.</p>
<p>This package aims to improve accesibility to statistical methods for analysing populations of resistant and non-resistant bacteria from an environmental, i.e. non-clinical perspective. The methods are intended to describe sensitivity, tolerance and resistance on a sub-acute level in order to compare populations of different origin on gradual scales.</p>
<p>We assume that environmental populations are composed of different geno- and phenotypes, so that quantitative data from standard methods like disc diffusion zone diameters (ZD) or minimum inhibitory concentration (MIC) values will yield multi-modal univariate mixture distributions when tested against single antibiotics.</p>
<p>The package relies on existing packages, especially packages <strong>evmix</strong> <span class="citation">(Hu and Scarrott 2018)</span> for boundary corrected density estimation and package <strong>bbmle</strong> <span class="citation">(Bolker and R Development Core Team 2017)</span> for maximum likelihood estimation. The package will be amended by visualization tools and interactive web-applications using R’s base graphics and statistics packages [RCore2015], packages <strong>ggplot2</strong> <span class="citation">(Wickham 2016)</span> and <strong>shiny</strong> <span class="citation">(Chang et al. 2018)</span>.</p>
<p><strong>Please note:</strong> The package and this document are in an early stage of development (alpha). It comes without warranty and is <strong>not intended for clinical applications</strong>. Its functions and classes are likely to change and may contain mistakes and errors. Source code of the development version is available from <a href="https://github.com/tpetzoldt/antibioticR" class="uri">https://github.com/tpetzoldt/antibioticR</a>. Comments are welcome.</p>
</div>
<div id="methods" class="section level1">
<h1 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h1>
<p>The package supports currently three methods:</p>
<ol style="list-style-type: decimal">
<li>Kernel density smoothing for getting mean values and multiple modes from the distributions,</li>
<li>An <strong>R</strong> implementation of the ECOFFinder <span class="citation">(Turnidge, Kahlmeter, and Kronvall 2006)</span> with automatic start value estimation and a shiny app for interactive use,</li>
<li>Maximum likelihood estimation of multi-modal normal and exponential-normal mixtures.</li>
</ol>
</div>
<div id="data-set" class="section level1">
<h1 class="hasAnchor">
<a href="#data-set" class="anchor"></a>Data set</h1>
<p>The data set for demonstrating main features of the package was provided by … It contains …</p>
<p>** the alpha version contains articficial test data**</p>
<p>After loading the package:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"antibioticR"</span>)</pre></body></html></div>
<p>we load the data and inspect its structure with <code>str</code>:</p>
<p>…</p>
</div>
<div id="identification-of-the-wild-type-population" class="section level1">
<h1 class="hasAnchor">
<a href="#identification-of-the-wild-type-population" class="anchor"></a>Identification of the wild-type population</h1>
<p>The wild type population is defined as “an isolate that it is devoid of phenotypically detectable acquired resistance mechanisms to a specified antimicrobial agent.” <span class="citation">(Kahlmeter, Turnidge, and Brown 2018)</span></p>
<div id="kernel-density-smoothing" class="section level2">
<h2 class="hasAnchor">
<a href="#kernel-density-smoothing" class="anchor"></a>Kernel density smoothing</h2>
<p>Lets assume a multi-modal distribution of zone diameters (zd in mm), here an example for <em>Escherichia coli</em> exposed to the antibiotic Piperacillin in an inhibtion test (data from <a href="http://www.eucast.org" class="uri">http://www.eucast.org</a>). The data are binned with a class frequency of 1mm and censored by a minimum value of 6mm, the diameter of the antibiotic test disc.</p>
<p>As not all density functions support weighted data (<strong>R</strong>’s <code>density</code>-function does, but the functions from <em>evmix</em> do not), we expand the binned vector to <em>raw data</em> with a helper function <code>unbin</code>:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">freq</span>    <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">36</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">9</span>,  <span class="fl">14</span>,  <span class="fl">10</span>, <span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>,
             <span class="fl">4</span>, <span class="fl">8</span>,  <span class="fl">20</span>,  <span class="fl">45</span>,  <span class="fl">40</span>,  <span class="fl">54</span> , <span class="fl">41</span>,  <span class="fl">22</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>)
<span class="no">classes</span> <span class="kw">&lt;-</span> <span class="fl">5</span> + (<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">freq</span>))
<span class="no">zd</span>      <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/unbin.html">unbin</a></span>(<span class="no">classes</span>, <span class="no">freq</span>)</pre></body></html></div>
<p>We shift the distribution by 0.5 to the class centers and use standard density smoothing with the default Gaussian kernel. It shows already good results for the rightmost (wild-type) and the intermediate component (sub-population). However, it is obviously not valid for the censored left component:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">zd</span>, <span class="kw">breaks</span> <span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">zd</span>))+<span class="fl">0.5</span>, <span class="kw">xlab</span><span class="kw">=</span><span class="st">"ZD (mm)"</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"antibiotic"</span>, <span class="kw">probability</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span>(<span class="no">zd</span>, <span class="kw">bw</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">zd</span>)))
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">v</span><span class="kw">=</span><span class="fl">6</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>, <span class="kw">lty</span><span class="kw">=</span><span class="st">"dashed"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="fu"><a href="../reference/abr_densfunctions.html">abr_density</a></span>(<span class="no">zd</span>, <span class="kw">cutoff</span> <span class="kw">=</span> <span class="fl">5.5</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"density"</span>),
                  <span class="kw">control</span> <span class="kw">=</span> <span class="fu"><a href="../reference/abr_densfunctions.html">abr_density.control</a></span>()), <span class="kw">col</span><span class="kw">=</span><span class="st">"lightblue"</span>, <span class="kw">lwd</span><span class="kw">=</span><span class="fl">3</span>)</pre></body></html></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>Function <code>abr_density</code> with option “density” is just a wrapper around this. It clips values below the interval, but does not correct its shape.</p>
<p>This can be improved with boundary corrected density estimation from package <strong>evmix</strong> <span class="citation">(Hu and Scarrott 2018)</span>:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">zd</span>, <span class="kw">breaks</span> <span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">zd</span>))+<span class="fl">0.5</span>, <span class="kw">xlab</span><span class="kw">=</span><span class="st">"ZD (mm)"</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"antibiotic"</span>, <span class="kw">probability</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="fu"><a href="../reference/abr_densfunctions.html">abr_density</a></span>(<span class="no">zd</span>, <span class="kw">cutoff</span> <span class="kw">=</span> <span class="fl">5.5</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"evmix"</span>),
            <span class="kw">control</span> <span class="kw">=</span> <span class="fu"><a href="../reference/abr_densfunctions.html">abr_density.control</a></span>()), <span class="kw">col</span><span class="kw">=</span><span class="st">"lightblue"</span>, <span class="kw">lwd</span><span class="kw">=</span><span class="fl">3</span>)</pre></body></html></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>Here, <code>bckden</code> from package <strong>evmix</strong> is called with a lower boundary <code>cutoff=5.5</code>mm, so that the antibiotic disc size of 6 mm becomes the class midpoint. The arguments of <code>dbckden</code> can be adapted with the <code>control</code> parameter.</p>
</div>
<div id="ecoffinder" class="section level2">
<h2 class="hasAnchor">
<a href="#ecoffinder" class="anchor"></a>ECOFFinder</h2>
<p>ECOFFinder is an algorithm developed by <span class="citation">Turnidge, Kahlmeter, and Kronvall (2006)</span>. Wild-type cut-off values for MIC data are estimated from quantiles of a normal distribution of <span class="math inline">\(\log_2\)</span> transformed MIC values. Mean and standard deviation of this distribution are estimated by non-linear regression between a normal probability distribution (that is scaled in y-direction by a parameter <span class="math inline">\(K\)</span>) and cumulative frequencies of observation data.</p>
<p>In order to separate the wild-type normal distribution from other components, e.g. the resistant sub-population, the regression is repeated using successive subsets of data, until an optimal fit between the subset and the normal probability function is found.</p>
<p>Firstly we load and inspect the test data set, included in the package:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">## raw data contain NA values</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">micdata</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(<span class="no">micdata</span>)</pre></body></html></div>
<pre><code>##        conc freq
## 6   0.03125    1
## 7   0.06250    5
## 8   0.12500   14
## 9   0.25000   80
## 10  0.50000  154
## 11  1.00000   57
## 12  2.00000   27
## 13  4.00000    5
## 14  8.00000    0
## 15 16.00000    4
## 16 32.00000    2</code></pre>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">freq</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">conc</span>), <span class="kw">data</span><span class="kw">=</span><span class="no">micdata</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"h"</span>)</pre></body></html></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>Then we omit not measured (NA) values, transform the data and plot the cumulative distribution:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co">## discard NA values</span>
<span class="no">measured</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(<span class="no">micdata</span>)

<span class="co">## cumulative plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="no">freq</span>) ~ <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">conc</span>), <span class="kw">data</span><span class="kw">=</span><span class="no">measured</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"l"</span>)</pre></body></html></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>Now we copy the transformed data to new variables <code>x</code>and <code>y</code> to save typing. Function <code>ecoffinder_startpar</code> then helps us to guess start parameters for the subsequent nonlinear regression. The function works internally by applying a kernel density estimation. Details can be found on the help page of <code>ecoffinder_startpar</code> and of R’s function <code>density</code>:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">measured</span>$<span class="no">conc</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">measured</span>$<span class="no">freq</span>

<span class="co">## heuristic start values</span>
<span class="no">pstart</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ecoffinder_startpar.html">ecoffinder_startpar</a></span>(<span class="no">x</span>, <span class="no">y</span>)
<span class="no">pstart</span></pre></body></html></div>
<pre><code>##       mean         sd          K 
##  -1.002944   1.150871 338.000000</code></pre>
<p>If the start parameters look reasonable, they can be directly fed into ecoffinder_nls`. This works well in many cases, but sometimes, it may be necessary to enter user-defined start parameters instead.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co">## nonlinear regression</span>
<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ecoffinder_nls.html">ecoffinder_nls</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="no">pstart</span>, <span class="kw">plot</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<pre><code>## Search concentration:  0 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">p</span>)</pre></body></html></div>
<pre><code>## 
## Formula: cumCount ~ fnorm(conc, mean, sd, K)
## 
## Parameters:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## mean  -1.54565    0.04257  -36.31 2.91e-08 ***
## sd     0.91042    0.05768   15.78 4.10e-06 ***
## K    339.02677    4.00460   84.66 1.83e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 7.179 on 6 degrees of freedom
## 
## Number of iterations to convergence: 8 
## Achieved convergence tolerance: 8.809e-06
## 
## ---
## ECOFF quantiles:
##  Q_0.95 Q_0.975  Q_0.99 Q_0.999 
##       1       2       2       4</code></pre>
<p>A visualisation is possible during the fitting process (<code>plot=TRUE</code>) or with a specialized plot function:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">p</span>)</pre></body></html></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">p</span>, <span class="kw">cumulative</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">fits</span><span class="kw">=</span><span class="st">"best"</span>)</pre></body></html></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p>Additional functions like <code>coef</code> or <code>abr_quantile</code> can be used to access additional results</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">p</span>)</pre></body></html></div>
<pre><code>##        mean          sd           K 
##  -1.5456547   0.9104227 339.0267704</code></pre>
<div class="sourceCode" id="cb19"><html><body><pre class="r"># abr_quantile(p, q=c(0.01, 0.1, 0.5, 0.9, 0.99)) # not yet implemented, needs log2_flag</pre></body></html></div>
</div>
<div id="mixture-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#mixture-approach" class="anchor"></a>Mixture approach</h2>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">breaks</span> <span class="kw">&lt;-</span> <span class="fl">0</span>:<span class="fl">28</span>
<span class="no">counts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">36</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">14</span>, <span class="fl">10</span>, <span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>,
            <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">20</span>, <span class="fl">45</span>, <span class="fl">40</span>, <span class="fl">54</span>, <span class="fl">41</span>, <span class="fl">22</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">0</span>)

<span class="no">observations</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/unbin.html">unbin</a></span>(<span class="no">breaks</span>[-<span class="fl">1</span>], <span class="no">counts</span>) <span class="co"># upper class boundaries</span>

(<span class="no">comp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mx_guess_components.html">mx_guess_components</a></span>(<span class="no">observations</span>, <span class="kw">bw</span><span class="kw">=</span><span class="fl">2</span>/<span class="fl">3</span>, <span class="kw">mincut</span><span class="kw">=</span><span class="fl">0.9</span>))</pre></body></html></div>
<pre><code>##        mean        sd         L
## 1  1.040054 0.7032986 0.1055751
## 2  7.805322 2.0509038 0.1775396
## 3 19.505968 2.1153693 0.7168853</code></pre>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">obj</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mxObj-methods.html">mxObj</a></span>(<span class="no">comp</span>, <span class="kw">left</span><span class="kw">=</span><span class="st">"e"</span>)

<span class="no">obj2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mx_metafit.html">mx_metafit</a></span>(<span class="no">breaks</span>, <span class="no">counts</span>, <span class="no">obj</span>)</pre></body></html></div>
<p>The results can then be plotted with function <code>mx_plot</code>. The optional <code>disc</code> argument adds the diameter of the antibiotic disc.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="../reference/mx_plot.html">mx_plot</a></span>(<span class="no">obj2</span>, <span class="kw">disc</span><span class="kw">=</span><span class="fl">5.5</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">""</span>, <span class="kw">xlab</span><span class="kw">=</span><span class="st">"ZD (mm)"</span>)</pre></body></html></div>
<p><img src="Introduction_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p>Numerical results can be obtained with:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">obj2</span>)</pre></body></html></div>
<pre><code>## Maximum likelihood estimation
## 
## Call:
## mle2(minuslogl = llunimix, start = parms)
## 
## Coefficients:
##        Estimate Std. Error  z value     Pr(z)    
## L1     0.102637   0.016246   6.3179 2.652e-10 ***
## L2     0.183466   0.020879   8.7872 &lt; 2.2e-16 ***
## rate1  7.891433   8.638539   0.9135     0.361    
## mean2  7.304443   0.283240  25.7889 &lt; 2.2e-16 ***
## sd2    2.140047   0.226415   9.4519 &lt; 2.2e-16 ***
## mean3 19.029089   0.126390 150.5588 &lt; 2.2e-16 ***
## sd3    1.948262   0.093759  20.7795 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## -2 log L: 1873.47</code></pre>
<p>or with:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="../reference/mx_results.html">results</a></span>(<span class="no">obj2</span>)</pre></body></html></div>
<pre><code>##      components        L1    rate1        L2    mean2      sd2       L3
## [1,]          3 0.1026367 7.891433 0.1834663 7.304443 2.140047 0.713897
##         mean3      sd3      q01      q05     L_q01    r2_var    r2_cor
## [1,] 19.02909 1.948262 14.49675 15.82448 0.7085714 0.9997274 0.9997277
##             EF
## [1,] 0.9997274</code></pre>
</div>
</div>
<div id="fiting-multiple-data-sets" class="section level1">
<h1 class="hasAnchor">
<a href="#fiting-multiple-data-sets" class="anchor"></a>Fiting multiple data sets</h1>
<p>… will follow</p>
</div>
<div id="finally" class="section level1">
<h1 class="hasAnchor">
<a href="#finally" class="anchor"></a>Finally</h1>
<p>… will follow</p>
</div>
<div id="acknowledgments" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h1>
<p>Many thanks to the EUCAST consortium and to the Hydrobiology work group of TU Dresden for test data sets, to John Turnidge, Stefanie Hess, Damiano Cacace. David Kneis and Thomas Berendonk for stimulation and discussion and to the R Core Team <span class="citation">(R Core Team 2015)</span> for developing and maintaining <strong>R</strong>. This documentation was written using <strong>knitr</strong> <span class="citation">(Xie 2014)</span> and <strong>rmarkdown</strong> <span class="citation">(Allaire et al. 2015)</span>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-rmarkdown">
<p>Allaire, JJ, Joe Cheng, Yihui Xie, Jonathan McPherson, Winston Chang, Jeff Allen, Hadley Wickham, and Rob Hyndman. 2015. <em>rmarkdown: Dynamic Documents for R</em>. <a href="https://CRAN.R-project.org/package=rmarkdown">https://CRAN.R-project.org/package=rmarkdown</a>.</p>
</div>
<div id="ref-amr2016">
<p>Antimicrobial Resistance, Review on. 2016. <em>Tackling Drug-Resistant Infections Globally: Final Report and Recommendations</em>. Review on Antimicrobial Resistance.</p>
</div>
<div id="ref-Berendonk2015">
<p>Berendonk, Thomas U., Célia M. Manaia, Christophe Merlin, Despo Fatta-Kassinos, Eddie Cytryn, Fiona Walsh, Helmut Bürgmann, et al. 2015. “Tackling Antibiotic Resistance: The Environmental Framework.” <em>Nature Reviews Microbiology</em> 13: 310. <a href="https://doi.org/10.1038/nrmicro3439">https://doi.org/10.1038/nrmicro3439</a>.</p>
</div>
<div id="ref-Bolker2017">
<p>Bolker, Ben, and R Development Core Team. 2017. “Bbmle: Tools for General Maximum Likelihood Estimation. R Package Version 1.0.20.” <a href="https://CRAN.R-project.org/package=bbmle">https://CRAN.R-project.org/package=bbmle</a>.</p>
</div>
<div id="ref-Chang2018">
<p>Chang, Winston, Joe Cheng, JJ Allaire, Yihui Xie, and Jonathan McPherson. 2018. <em>Shiny: Web Application Framework for R</em>. <a href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</a>.</p>
</div>
<div id="ref-ECDC2017">
<p>ECDC. 2017. <em>Surveillance of Antimicrobial Resistance in Europe 2016. Annual Report of the European Antimicrobial Resistance Surveillance Network (Ears-Net)</em>. Stockholm: European Centre for Disease Prevention and Control. <a href="https://ecdc.europa.eu/">https://ecdc.europa.eu/</a>.</p>
</div>
<div id="ref-Hu2018">
<p>Hu, Yang, and Carl Scarrott. 2018. “evmix: An R Package for Extreme Value Mixture Modeling, Threshold Estimation and Boundary Corrected Kernel Density Estimation.” <em>Journal of Statistical Software</em> 84 (5): 1–27. <a href="https://doi.org/10.18637/jss.v084.i05">https://doi.org/10.18637/jss.v084.i05</a>.</p>
</div>
<div id="ref-Kahlmeter2018">
<p>Kahlmeter, Gunnar, John Turnidge, and Derek Brown. 2018. “EUCAST General Consultation on "Considerations in the Numerical Estimation of Epidemiological Cutoff (Ecoff) Values".” Draft paper, May 31, 2018. <a href="http://www.eucast.org/fileadmin/src/media/PDFs/EUCAST_files/MIC_distributions/ECOFF_procedure_2018_General_Consultation_20180531.pdf">http://www.eucast.org/fileadmin/src/media/PDFs/EUCAST_files/MIC_distributions/ECOFF_procedure_2018_General_Consultation_20180531.pdf</a>.</p>
</div>
<div id="ref-RCore2015">
<p>R Core Team. 2015. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-Roca2015">
<p>Roca, Ignasi, Murat Akova, F Baquero, J Carlet, M Cavaleri, S Coenen, J Cohen, et al. 2015. “The Global Threat of Antimicrobial Resistance: Science for Intervention.” <em>New Microbes and New Infections</em> 6: 22–29. <a href="https://doi.org/10.1016/j.nmni.2015.02.007">https://doi.org/10.1016/j.nmni.2015.02.007</a>.</p>
</div>
<div id="ref-Turnidge2006">
<p>Turnidge, J., G. Kahlmeter, and G. Kronvall. 2006. “Statistical Characterisation of Bacterial Wild-Type MIC Value Distributions and the Determination of Epidemiological Cut-Off Values.” <em>Clinical Microbiology and Infection</em> 12 (5): 418–25. <a href="https://doi.org/10.1111/j.1469-0691.2006.01377.x">https://doi.org/10.1111/j.1469-0691.2006.01377.x</a>.</p>
</div>
<div id="ref-Wickham2016">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="http://ggplot2.org">http://ggplot2.org</a>.</p>
</div>
<div id="ref-knitr2014">
<p>Xie, Yihui. 2014. “knitr: A Comprehensive Tool for Reproducible Research in R.” In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman; Hall/CRC. <a href="https://www.crcpress.com/product/isbn/9781466561595">https://www.crcpress.com/product/isbn/9781466561595</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thomas Petzoldt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
